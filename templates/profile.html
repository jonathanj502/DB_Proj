<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>{{ profile.username }} — Profile</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
  <header style="max-width:1000px;margin:12px auto;padding:0 16px;">
    <a href="{{ url_for('index') }}">&larr; Home</a>
  </header>

  <main style="max-width:720px;margin:24px auto;padding:16px;">
    <div style="display:flex;align-items:center;gap:16px;">
      <img src="{{ url_for('static', filename='img/default-avatar.png') }}" alt="{{ profile.username }}"
           style="width:72px;height:72px;border-radius:50%;object-fit:cover;border:1px solid #ddd;">
      <div>
        <h1 style="margin:0">{{ profile.username }}</h1>
        <p style="margin:6px 0 0;color:#666">Joined: {{ profile.joined_at }}</p>
      </div>
    </div>

    <!-- add bookshelves list -->
    <section style="margin-top:20px;">
      <h2 style="margin-bottom:8px;">Bookshelves</h2>

      {% if bookshelves %}
        <ul style="list-style:none;padding:0;margin:0;display:grid;gap:12px;">
          {% for bs in bookshelves %}
            <li style="padding:10px;border:1px solid #eee;border-radius:6px;">
              <div style="display:flex;align-items:center;gap:12px;">
                <div style="flex:1;">
                  {% if has_view_bookshelf %}
                    <a href="{{ url_for('view_bookshelf', bookshelf_id=bs.id) }}" style="font-weight:600;">
                      {{ bs.name }}
                    </a>
                  {% else %}
                    <span style="font-weight:600;">{{ bs.name }}</span>
                  {% endif %}
                  <div style="color:#666;font-size:0.9rem;margin-top:4px;">
                    {{ bs.created_at }}{% if not bs.is_public %} • private{% endif %}
                  </div>
                </div>
              </div>
              {% if bs.description %}
                <p style="margin:8px 0 0;color:#444;">{{ bs.description }}</p>
              {% endif %}
            </li>
          {% endfor %}
        </ul>
      {% else %}
        {% if is_owner %}
          <p style="color:#666;">You haven't created any bookshelves yet.</p>
        {% else %}
          <p style="color:#666;">This user has no public bookshelves.</p>
        {% endif %}
      {% endif %}
    </section>

    <!-- logout form visible only to profile owner -->
    {% if is_owner %}
    <form method="post" action="{{ url_for('logout') }}" style="margin-top:16px;">
      <button type="submit" style="padding:8px 12px;border-radius:4px;border:1px solid #ccc;background:#fff;cursor:pointer;">
        Log out
      </button>
    </form>
    {% endif %}
    
  </main>
</body>
</html>